<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>블소와인</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://vjs.zencdn.net/5.15.1/video-js.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/react@15/dist/react.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
	<script type="text/javascript" src="https://vjs.zencdn.net/5.15.1/video.js"></script>
	<script type="text/javascript" src="lib/videojs.hotkeys.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/javascript" src="js/index.js"></script>
    <pre>
'Microsoft Internet Controls Library
'Microsoft HTML Object Library
'Microsoft XML, v 6.0

Private startRow As Integer
Private targetYear As Integer
Private titleRowHeight As Integer, titleBgColor As Object, titleFontSize As String, titleFontName As String
Private monthRowHeight As Integer, monthBgColor As Object, monthFontSize As String, monthFontName As String
Private sheetName As String

Sub DoCrawling()
    Dim IE As Object, subject As Object
    OpenIE IE

    sheetName = "Sheet2"
    startRow = 1
    targetYear = 2020

'    서울시 IE
'    부산시 IE
'    대구시 IE

'    인천시육아종합지원센터 IE
'    인천부평구육아종합지원센터 IE
    인천미추홀구육아종합지원센터 IE

    CloseIE IE
    MsgBox "완료"
End Sub

Sub 서울시(ByRef IE As Object)
서울시육아종합지원센터 IE
    강남구육아종합지원센터 IE
    강동구육아종합지원센터 IE
    강서구육아종합지원센터 IE
    관악구육아종합지원센터 IE
    광진구육아종합지원센터 IE
    금천구육아종합지원센터 IE
    노원구육아종합지원센터 IE
    도봉구육아종합지원센터 IE
    동대문구육아종합지원센터 IE
    동작구육아종합지원센터 IE
    마포구육아종합지원센터 IE
    서초구육아종합지원센터 IE
    구로구육아종합지원센터 IE
    은평구육아종합지원센터 IE
    영등포구육아종합지원센터 IE
    중랑구육아종합지원센터 IE
    서대문구육아종합지원센터 IE
    양천구육아종합지원센터 IE
    강북구육아종합지원센터 IE
    용산구육아종합지원센터 IE
    중구육아종합지원센터 IE
    종로구육아종합지원센터 IE
    '성동구육아종합지원센터 IE 성동구 웹사이트가 자꾸 다운 추후 작업
    '성북구는 교육일정을 찾기가 힘들다
    '송파구 네이버 카페 가입해야 한다.
End Sub

Sub 부산시(ByRef IE As Object)
    부산시육아종합지원센터 IE
    사상구육아종합지원센터 IE
    부산진구육아종합지원센터 IE
    기장군육아종합지원센터 IE
    해운대구육아종합지원센터 IE
    동래구육아종합지원센터 IE
    연제구육아종합지원센터 IE
    수영구육아종합지원센터 IE
    북구육아종합지원센터 IE
End Sub

Sub 대구시(ByRef IE As Object)
    대구시육아종합지원센터 IE
    대구동구육아종합지원센터 IE
End Sub


Sub 강남구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer
    
    InitCenter "강남구육아종합지원센터"
    
'    For idx = 0 To 11:
'        monArr(idx) = startRow
'    Next
'
'    Dim xmlhttp As New MSXML2.XMLHTTP60, html As New HTMLDocument
'    For i = 1 To 12
'        j = monArr(i - 1)
'
'        With xmlhttp
'            .Open "POST", "http://gncare.go.kr/gnccic/education/choiceGubun.php", False
'            .setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
'            .send "GUBUN=0&STATUS=&EDU_YEAR=CStr(targetYear)&EDU_MONTH=CStr(i)&EDU_DAY="
'            html.body.innerHTML = xmlhttp.responseText
'            For Each article In html.querySelectorAll("a")
'                Sheets(sheetName).Cells(j, i) = Trim(article.innerText)
'                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://gncare.go.kr" + article.getAttribute("href")
'            Next
'
'            j = j + 1
'            monArr(i - 1) = j
'
'            If temp < j Then
'                temp = j
'            End If
'        End With
'    Next
    
    
    ChangeNavigate IE, "http://gncare.go.kr/gnccic_child/education/education3.php"
    Application.Wait DateAdd("s", 5, Now)

    ChoiceSelectBox IE.document.getElementById("EDU_YEAR"), targetYear

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    GoSub doCraw

    ChangeNavigate IE, "http://gncare.go.kr/gnccic/education/education1.php"
    Application.Wait DateAdd("s", 5, Now)
    ChoiceSelectBox IE.document.getElementById("EDU_YEAR"), targetYear

    temp = 0

    GoSub doCraw

Final:

    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

Exit Sub

doCraw:
    For i = 1 To 12
        ChoiceSelectBox IE.document.getElementById("EDU_MONTH"), i
        ClickButton IE.document.getElementsByClassName("searchButton")(0)
        Application.Wait DateAdd("s", 3, Now)

        j = monArr(i - 1)

        For Each article In IE.document.getElementById("edu_schedule_list").Children
            Set subject = article.getElementsByClassName("subject")(0)
            Sheets(sheetName).Cells(j, i) = Trim(subject.Children(0).innerText)
            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://gncare.go.kr" + subject.Children(0).getAttribute("href")
            j = j + 1
        Next

        monArr(i - 1) = j

        If temp < j Then
            temp = j
        End If
    Next
Return
End Sub

Sub 강동구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, month As String, href As String, idx As String, idxIdx As Integer, id As String, idIdx As Integer
    
    InitCenter "강동구육아종합지원센터"
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = startRow
        
        '보육교직원 교육
        ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule002.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month
        goyuk = "보육"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("paging_area").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling)
                nextHref = IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling.getAttribute("href")
                startCom = InStr(nextHref, "'")
                endCom = InStr(startCom + 1, nextHref, "'")
                cpage = Mid(nextHref, startCom + 1, endCom - startCom - 1)
                ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule002.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month + "&cpage=" + cpage
                WaitIE IE
                GoSub doCraw
            Loop
        End If

        '부모교육
        ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule003.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month
        goyuk = "부모"
        
        GoSub doCraw
        If IE.document.getElementsByClassName("paging_area").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling)
                nextHref = IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling.getAttribute("href")
                startCom = InStr(nextHref, "'")
                endCom = InStr(startCom + 1, nextHref, "'")
                cpage = Mid(nextHref, startCom + 1, endCom - startCom - 1)
                ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule003.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month + "&cpage=" + cpage
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '행사(개인)
        ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule001.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month
        goyuk = "행사(개인)"
        
        GoSub doCraw
        If IE.document.getElementsByClassName("paging_area").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling)
                nextHref = IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling.getAttribute("href")
                startCom = InStr(nextHref, "'")
                endCom = InStr(startCom + 1, nextHref, "'")
                cpage = Mid(nextHref, startCom + 1, endCom - startCom - 1)
                ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule001.do?gubun=11&this_mon=" + CStr(targetYear) + "-" + month + "&cpage=" + cpage
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '행사(단체)
        ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule003.do?gubun=12&this_mon=" + CStr(targetYear) + "-" + month
        goyuk = "행사(단체)"
        
        GoSub doCraw
        If IE.document.getElementsByClassName("paging_area").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling)
                nextHref = IE.document.getElementsByClassName("paging_area")(0).getElementsByTagName("strong")(0).nextElementSibling.getAttribute("href")
                startCom = InStr(nextHref, "'")
                endCom = InStr(startCom + 1, nextHref, "'")
                cpage = Mid(nextHref, startCom + 1, endCom - startCom - 1)
                ChangeNavigate IE, "https://www.gdkids.or.kr:8443/front/program/plan/schedule003.do?gubun=12&this_mon=" + CStr(targetYear) + "-" + month + "&cpage=" + cpage
                WaitIE IE
                GoSub doCraw
            Loop
        End If
    Next

Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub
    
doCraw:
    For Each article In IE.document.getElementsByClassName("list fixed")(0).getElementsByTagName("tbody")(0).Children
        Set subject = article.getElementsByClassName("alignl")(0)

        If Not (subject Is Nothing) Then
            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
            href = subject.Children(0).getAttribute("href") 'javascript:fnDetail('38666','P004')
            idxIdx = InStr(href, "('")
            idx = Mid(href, idxIdx + 2, InStr(idxIdx + 2, href, "'") - idxIdx - 2)
            idIdx = InStr(href, ",")
            id = Mid(href, idIdx + 2, InStr(idIdx + 2, href, "'") - idIdx - 2)
            
            If goyuk = "보육" Then
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gdkids.or.kr:8443/front/program/plan/programWrite.do?idx=" + idx + "&ppid=" + id + "&listMenuId=27d2a673402544c6acd1ca1a31f7f1f4&listUrl=/plan/schedule002.do&gubun=11&peopleGb=0"
            ElseIf goyuk = "부모" Then
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gdkids.or.kr:8443/front/program/plan/programWrite.do?idx=" + idx + "&ppid=" + id + "&listMenuId=c64e5e1ff64d40579b693a509fa68c0d&listUrl=/plan/schedule003.do&gubun=11&peopleGb=0"
            ElseIf goyuk = "행사(개인)" Then
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gdkids.or.kr:8443/front/program/plan/programWrite.do?idx=" + idx + "&ppid=" + id + "&listMenuId=5b68473256744f7fa54692184090d7e8&listUrl=/plan/schedule001.do&gubun=11&peopleGb=1"
            ElseIf goyuk = "행사(단체)" Then
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gdkids.or.kr:8443/front/program/plan/programWrite.do?idx=" + idx + "&ppid=" + id + "&listMenuId=ff97557cd4ad41919f750854492a95df&listUrl=/plan/schedule001.do&gubun=12&peopleGb=2"
            End If
            
            j = j + 1
            
            If temp < j Then
                temp = j
            End If
        End If
    Next
Return
End Sub

Sub 강서구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, month As String, href As String, pageCount As Integer
    
    InitCenter "강서구육아종합지원센터"
    Application.Wait DateAdd("s", 1, Now)
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        ChangeNavigate IE, "https://www.gskids.or.kr/html/sub/index.php?pno=050101&search=&keyword=&edu_kind=&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&page=1"
        
        j = startRow
        For pageCount = 1 To IE.document.getElementsByClassName("board_page")(0).getElementsByTagName("table")(1).getElementsByTagName("td")(2).Children.Length
            If pageCount > 1 Then
                ChangeNavigate IE, "https://www.gskids.or.kr/html/sub/index.php?pno=050101&search=&keyword=&edu_kind=&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&page=" + CStr(pageCount)
            End If
            
            For Each article In IE.document.getElementById("board_list").getElementsByTagName("tr")
                Set subject = article.getElementsByClassName("board_item2")(0)
            
                If Not (subject Is Nothing) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    href = subject.Children(0).getAttribute("href")
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gskids.or.kr/" + Mid(href, InStr(href, "html"))
                    j = j + 1
                End If
            Next
        Next
        
        If temp < j Then
            temp = j
        End If
    Next

    AdStyle startRow - 1, temp - 1

    startRow = temp + 1
End Sub

Sub 관악구육아종합지원센터(ByRef IE As Object)
    Dim i As Long, j As Long, temp As Long, href As String, cbIdx As Long, bcIdx As Long, parentSeq As Long, startCom As Long, endCom As Long, calen As String, nun As Long, monArr(12) As Integer
    
    InitCenter "관악구육아종합지원센터"
    
    ChangeNavigate IE, "http://www.gwanak.go.kr/site/educare/ex/bbs/List.do?cbIdx=494"
    Application.Wait DateAdd("s", 1, Now)
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    GoSub doCraw
    
    nextStr = IE.document.getElementsByClassName("paging")(0).getElementsByClassName("num current")(0).NextSibling.getAttribute("onclick")
    nextIdx = Mid(lastStr, InStr(nextStr, "(") + 1, InStr(nextStr, ")") - InStr(nextStr, "(") - 1)

    Do Until IE.document.getElementsByClassName("paging")(0).getElementsByClassName("num current")(0).innerText = nextIdx
        IE.document.getElementsByClassName("paging")(0).getElementsByClassName("num current")(0).NextSibling.Click
        WaitIE IE
        
        nextStr = IE.document.getElementsByClassName("paging")(0).getElementsByClassName("num current")(0).NextSibling.getAttribute("onclick")
        nextIdx = Mid(nextStr, InStr(nextStr, "(") + 1, InStr(nextStr, ")") - InStr(nextStr, "(") - 1)
        
        GoSub doCraw
    Loop

Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        calen = article.Children(3).innerText
        startCom = InStr(calen, ".")
        endCom = InStr(startCom + 1, calen, ".")
        nun = Mid(calen, 1, startCom - 1)
        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
        j = monArr(i - 1)

        If targetYear = nun Then
            Set subject = article.getElementsByClassName("title")(0)
            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
            href = subject.Children(0).getAttribute("onClick")
            'http://www.gwanak.go.kr/site/educare/ex/bbs/View.do?cbIdx=494&bcIdx=113784&parentSeq=113784
            'doBbsFView('494','113784','16010100','113784');return false;
            startCom = InStr(href, "'")
            endCom = InStr(startCom + 1, href, "'")
            cbIdx = Mid(href, startCom + 1, endCom - startCom - 1)

            startCom = InStr(endCom + 1, href, "'")
            endCom = InStr(startCom + 1, href, "'")
            bcIdx = Mid(href, startCom + 1, endCom - startCom - 1)

            startCom = InStr(endCom + 1, href, "'")
            endCom = InStr(startCom + 1, href, "'")

            startCom = InStr(endCom + 1, href, "'")
            endCom = InStr(startCom + 1, href, "'")
            parentSeq = Mid(href, startCom + 1, endCom - startCom - 1)

            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.gwanak.go.kr/site/educare/ex/bbs/View.do?cbIdx=" + CStr(cbIdx) + "&bcIdx=" + CStr(bcIdx) + "&parentSeq=" + CStr(parentSeq)
            j = j + 1
            monArr(i - 1) = j

            If temp < j Then
                temp = j
            End If
        End If

        If targetYear > nun Then
            GoTo Final
        End If
    Next
Return
End Sub

Sub 광진구육아종합지원센터(ByRef IE As Object)
    Dim i As Long, j As Long, temp As Long, href As String, cbIdx As Long, bcIdx As Long, parentSeq As Long, startCom As Long, endCom As Long, calen As String, nun As Long, monArr(12) As Integer, yearFlag As Boolean
    
    InitCenter "광진구육아종합지원센터"
    
    '부모교육 및 행사
    ChangeNavigate IE, "https://www.gjcare.go.kr/html/sub/index.php?pno=060101"
    Application.Wait DateAdd("s", 1, Now)

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    GoSub doCraw

    yearFlag = False
    Do Until IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).getAttribute("href") = "#next-page"
        If yearFlag Then
            Exit Do
        End If

        IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).NextSibling.NextSibling.Click
        WaitIE IE

        GoSub doCraw
    Loop

    '어린이집 행사
    ChangeNavigate IE, "https://www.gjcare.go.kr/html/sub/index.php?pno=060301"
    Application.Wait DateAdd("s", 1, Now)

    GoSub doCraw

    yearFlag = False
    Do Until IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).getAttribute("href") = "#next-page"
        If yearFlag Then
            Exit Do
        End If

        IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).NextSibling.NextSibling.Click
        WaitIE IE

        GoSub doCraw
    Loop
    
    '아동학대 예방 교육신청
    ChangeNavigate IE, "https://www.gjcare.go.kr/html/sub/index.php?pno=060701"
    Application.Wait DateAdd("s", 1, Now)
    
    GoSub doCraw

    yearFlag = False
    Do Until IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).getAttribute("href") = "#next-page"
        If yearFlag Then
            Exit Do
        End If
        
        IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).NextSibling.NextSibling.Click
        WaitIE IE

        GoSub doCraw
    Loop

Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("board")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        calen = article.Children(2).innerText
        startCom = InStr(calen, "-")
        endCom = InStr(startCom + 1, calen, "-")
        If InStr(calen, ":") = 0 Then
            nun = Mid(calen, 1, 4)
        Else
            nun = Mid(calen, InStr(calen, ":") + 2, 4)
        End If
        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
        j = monArr(i - 1)
        
        If targetYear = nun Then
            'Set subject = article.getElementsByClassName("left subject")(0)
            Set subject = article.Children(1)
            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
            href = subject.Children(0).getAttribute("href")
            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.gjcare.go.kr/" + Mid(href, InStr(href, "html"))
            j = j + 1
            monArr(i - 1) = j

            If temp < j Then
                temp = j
            End If
        End If

        If targetYear > nun Then
            yearFlag = True
            Exit For
        End If
    Next
Return
End Sub

Sub 금천구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String
    
    InitCenter "금천구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    GoSub doCraw

    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
    
    Exit Sub

doCraw:
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        ChangeNavigate IE, "http://www.happycare.or.kr/html/sub/index.php?pno=050101&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&sch_gubun="
        
        j = monArr(i - 1)
    
        For Each article In IE.document.getElementById("board_list").getElementsByTagName("tbody")(0).Children
            Set subject = article.getElementsByClassName("board_item pdl15")(0)
            If Not (subject Is Nothing) Then
                Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.happycare.or.kr" + subject.Children(0).getAttribute("href")
                j = j + 1
            End If
        Next
        
        monArr(i - 1) = j
    
        If temp < j Then
            temp = j
        End If
    Next
Return
End Sub

Sub 노원구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String, trLeng As Integer

    InitCenter "노원구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If

        ChangeNavigate IE, "http://www.nwscc.or.kr/php/index.php?pno=050700&yy=" + CStr(targetYear) + "&mm=" + month

        j = monArr(i - 1)

        GoSub doCraw
        
        trLeng = IE.document.getElementById("displayNum3").getElementsByTagName("table")(2).getElementsByTagName("tbody")(0).getElementsByTagName("tr").Length
        
        If trLeng > 3 Then
            Do Until IsNull(IE.document.getElementById("displayNum3").getElementsByTagName("table")(2).getElementsByTagName("tbody")(0).getElementsByTagName("tr")(trLeng - 1).getElementsByTagName("b")(0).nextElementSibling)
                IE.document.getElementById("displayNum3").getElementsByTagName("table")(2).getElementsByTagName("tbody")(0).getElementsByTagName("tr")(trLeng - 1).getElementsByTagName("b")(0).nextElementSibling.Click
                WaitIE IE
                GoSub doCraw
                trLeng = IE.document.getElementById("displayNum3").getElementsByTagName("table")(2).getElementsByTagName("tbody")(0).getElementsByTagName("tr").Length
            Loop
        End If
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementById("displayNum3").getElementsByTagName("table")(2).getElementsByTagName("tbody")(0).Children
        If Not (article.Children(3) = "") Then
            Set subject = article.Children(3)
            If Not (subject Is Nothing) Then
                Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.innerText) & vbCrLf
                'Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.happycare.or.kr" + subject.Children(0).getAttribute("href")
                j = j + 1
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 도봉구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "도봉구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If

        ChangeNavigate IE, "https://www.doccic.go.kr:4435/care/html/sub/index.php?pno=010101&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&s_cd="
        
        j = monArr(i - 1)

        GoSub doCraw
        
        If IE.document.getElementById("pageList").Children.Length > 0 Then
            Do Until IsNull(IE.document.getElementById("pageList").getElementsByClassName("bold")(2).nextElementSibling)
                IE.document.getElementById("pageList").getElementsByClassName("bold")(2).nextElementSibling.Click
                WaitIE IE
                GoSub doCraw
            Loop
        End If
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementById("board_list").getElementsByTagName("tbody")(0).Children
        Set subject = article.getElementsByClassName("board_item pdl15 center")(0)
        If Not (subject Is Nothing) Then
            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.innerText) & vbCrLf
            'Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.happycare.or.kr" + subject.Children(0).getAttribute("href")
            j = j + 1
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 동대문구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "동대문구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '답십리점
        ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=030901&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&gubun="
        
        GoSub doCraw
        
        For idx = 3 To IE.document.getElementById("helpbox").nextElementSibling.nextElementSibling.nextElementSibling.getElementsByTagName("a").Length
            ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=030901&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&sitem=&skey=&page=" + CStr(idx - 1)
            GoSub doCraw
        Next
        
        '제기점
        ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=030902&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&gubun="
        
        GoSub doCraw
        
        For idx = 3 To IE.document.getElementById("helpbox").nextElementSibling.nextElementSibling.nextElementSibling.getElementsByTagName("a").Length
            ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=030902&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&sitem=&skey=&page=" + CStr(idx - 1)
            GoSub doCraw
        Next
        
        '보육교직원 교육
        ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=020601&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&gubun="
        
        GoSub doCraw
        
        For idx = 3 To IE.document.getElementById("helpbox").nextElementSibling.nextElementSibling.nextElementSibling.getElementsByTagName("a").Length
            ChangeNavigate IE, "https://ddmccic.or.kr/html/sub/index.php?pno=020601&toYear=" + CStr(targetYear) + "&toMonth=" + month + "&sitem=&skey=&page=" + CStr(idx - 1)
            GoSub doCraw
        Next
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementById("helpbox").nextElementSibling.nextElementSibling.getElementsByTagName("table")(1).getElementsByTagName("tbody")(0).Children
        Set subject = article.getElementsByClassName("bbs_default")(0)
        If Not (subject Is Nothing) Then
            If Not IsEmpty(subject.Children(0)) Then
                Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://ddmccic.or.kr" + subject.Children(0).getAttribute("href")
                j = j + 1
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 동작구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "동작구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        ChangeNavigate IE, "https://dccic.go.kr/html/sub/index.php?pno=060201&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&sch_gubun="
        
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("tb_style03")(0).getElementsByTagName("tbody")(0).Children
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://dccic.go.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 마포구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "마포구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        ChangeNavigate IE, "https://mcic.or.kr/sub/education/education.php?y=" + CStr(targetYear) + "&m=" + month
        
        GoSub doCraw
                           
        If IE.document.getElementsByClassName("pagination pagination-right").Length > 0 Then
            For idx = 2 To IE.document.getElementsByClassName("pagination pagination-right")(0).Children.Length - 1
                ChangeNavigate IE, "https://mcic.or.kr/sub/education/education.php?y=" + CStr(targetYear) + "&m=" + month + "&opt=&subject=&page=" + CStr(idx)
                GoSub doCraw
            Next
        End If
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("table texttable center")(0).getElementsByTagName("tbody")(0).Children
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    'Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://dccic.go.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 서초구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "서초구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '어린이집
        ChangeNavigate IE, "http://youngua.seocho.go.kr/care/html/sub/index.php?pno=020101&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        GoSub doCraw
        
        '부모
        ChangeNavigate IE, "http://youngua.seocho.go.kr/yua/html/sub/index.php?pno=020301&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        GoSub doCraw
        
        '신반포 부모
        ChangeNavigate IE, "http://youngua.seocho.go.kr/sinbp/html/sub/index.php?pno=020301&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("board_item pdl15 bdb")
        If Not IsEmpty(article.Children(0)) Then
            Set subject = article
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://youngua.seocho.go.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 성동구육아종합지원센터(ByRef IE As Object)
    Dim i As Long, j As Long, temp As Long, href As String, cbIdx As Long, bcIdx As Long, parentSeq As Long, startCom As Long, endCom As Long, calen As String, nun As Long, monArr(12) As Integer, yearFlag As Boolean
    
    InitCenter "성동구육아종합지원센터"
    
    '보육교직원 교육
    ChangeNavigate IE, "http://ccic.sd.go.kr/nurture/nurture_01.asp"
    Application.Wait DateAdd("s", 1, Now)

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    GoSub doCraw

'    yearFlag = False
'    Do Until IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).getAttribute("href") = "#next-page"
'        If yearFlag Then
'            Exit Do
'        End If
'
'        IE.document.getElementsByClassName("pager")(0).getElementsByClassName("on")(0).NextSibling.NextSibling.Click
'        WaitIE IE
'
'        GoSub doCraw
'    Loop

    '가정양육지원 프로그램

Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("txt")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(0)) Then
            Set subject = article.Children(0)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(article.Children(0).Children(0)) Then
                    calen = article.Children(1).innerText
                    startCom = InStr(calen, "-")
                    endCom = InStr(startCom + 1, calen, "-")
                    If InStr(calen, ":") = 0 Then
                        nun = Mid(calen, 1, 4)
                    Else
                        nun = Mid(calen, InStr(calen, ":") + 2, 4)
                    End If
                    i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                    j = monArr(i - 1)
                    
                    If targetYear = nun Then
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://ccic.sd.go.kr/nurture/" + subject.Children(0).getAttribute("href")
                        
                        j = j + 1
                        monArr(i - 1) = j
            
                        If temp < j Then
                            temp = j
                        End If
                    End If
            
                    If targetYear > nun Then
                        yearFlag = True
                        Exit For
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 종로구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "종로구육아종합지원센터"
      
    ChangeNavigate IE, "http://www.jnccic.or.kr/programeducation/programeducation_bteacher.html?category=3"
    Application.Wait DateAdd("s", 1, Now)

    IE.document.getElementById("start_date").Value = CStr(targetYear) + "-01-01"
    IE.document.getElementById("end_date").Value = CStr(targetYear) + "-12-31"

    ClickButton IE.document.getElementById("category_id03")
    Application.Wait DateAdd("s", 4, Now)

    ClickButton IE.document.getElementById("category_id04")
    Application.Wait DateAdd("s", 4, Now)

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    GoSub doCraw

    If IE.document.getElementsByClassName("navigator")(0).Children.Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("navigator")(0).getElementsByClassName("pagingOn")(0).nextElementSibling)
            If IE.document.getElementsByClassName("navigator")(0).getElementsByClassName("pagingOn")(0).nextElementSibling.tagName = "A" Then
                If IE.document.getElementsByClassName("navigator")(0).getElementsByClassName("pagingOn")(0).nextElementSibling.getAttribute("href") = "javascript:contentList('', '');" Then
                    Exit Do
                End If
            End If
            ClickButton IE.document.getElementsByClassName("navigator")(0).getElementsByClassName("pagingOn")(0).nextElementSibling.Children(0)
            WaitIE IE
            Application.Wait DateAdd("s", 4, Now)
            GoSub doCraw
        Loop
    End If
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("tableTopC")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    calen = article.Children(2).innerText
                    startCom = InStr(calen, ".")
                    endCom = InStr(startCom + 1, calen, ".")
                    If InStr(calen, ":") = 0 Then
                        nun = Mid(calen, 1, 4)
                    Else
                        nun = Mid(calen, InStr(calen, ":") + 2, 4)
                    End If
                    i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                    j = monArr(i - 1)
                    
                    If targetYear = nun Then
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.jnccic.or.kr/programeducation/" + subject.Children(0).getAttribute("href")
                        
                        j = j + 1
                        monArr(i - 1) = j
            
                        If temp < j Then
                            temp = j
                        End If
                    End If
            
                    If targetYear > nun Then
                        yearFlag = True
                        Exit For
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 구로구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "구로구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '보육교직원 교육
        ChangeNavigate IE, "http://guroccic.guro.go.kr/html/sub/index.php?pno=020305&cyear=" + CStr(targetYear) + "&cmonth=" + month
        GoSub doCraw
        
        '부모교육
        ChangeNavigate IE, "http://guroccic.guro.go.kr/html/sub/index.php?pno=030302&cyear=" + CStr(targetYear) + "&cmonth=" + month
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementById("board_list").getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(4)) Then
            Set subject = article.Children(4)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://guroccic.guro.go.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 은평구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "은평구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '부모교육
        ChangeNavigate IE, "http://www.epmjuccic.co.kr/html/sub/index.php?pno=030201&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        
        GoSub doCraw
        
        If Not IsEmpty(getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/btn/icon_last.gif")) Then
            Set img = getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/btn/icon_last.gif")
            
            imghref = img.parentElement.getAttribute("href")
            startCom = InStr(imghref, "page=")
            pageLeng = CInt(Mid(imghref, startCom + 5))
            
            For pageNum = 2 To pageLeng
                ChangeNavigate IE, "http://www.epmjuccic.co.kr/html/sub/index.php?pno=030201&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&0=&page=" + CStr(pageNum)
                GoSub doCraw
            Next
        End If
        
        '보육보직원 교육
        ChangeNavigate IE, "http://www.epmjuccic.co.kr/html/sub/index.php?pno=040401&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        
        GoSub doCraw
        
        If Not IsEmpty(getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/btn/icon_last.gif")) Then
            Set img = getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/btn/icon_last.gif")
            
            imghref = img.parentElement.getAttribute("href")
            startCom = InStr(imghref, "page=")
            pageLeng = CInt(Mid(imghref, startCom + 5))
            
            For pageNum = 2 To pageLeng
                ChangeNavigate IE, "http://www.epmjuccic.co.kr/html/sub/index.php?pno=040401&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&0=&page=" + CStr(pageNum)
                GoSub doCraw
            Next
        End If
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementById("board_list").getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.epmjuccic.co.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 영등포구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "영등포구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '보육교직원 교육
        ChangeNavigate IE, "http://www.ydpccic.or.kr/bbs/board.php?bo_table=s2_7&year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw
        
        '부모교육
        ChangeNavigate IE, "http://www.ydpccic.or.kr/bbs/board.php?bo_table=s3_8&year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("tbl_head01 tbl_wrap")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 중랑구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "중랑구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        ChangeNavigate IE, "https://www.jccic.or.kr/2018/sub41.php?playYear=" + CStr(targetYear) + "&playMonth=" + month + "&at="
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("__tbl-list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.jccic.or.kr/2018/" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 서대문구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "서대문구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)

        '보육보직원 교육
        ChangeNavigate IE, "http://www.sdmccic.or.kr/?pno=050202&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        
        GoSub doCraw
        
        If Not IsEmpty(getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/v2/common/pg_last.png")) Then
            Set img = getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/v2/common/pg_last.png")
            
            imghref = img.parentElement.getAttribute("href")
            startCom = InStr(imghref, "page=")
            pageLeng = CInt(Mid(imghref, startCom + 5))
            
            For pageNum = 2 To pageLeng
                ChangeNavigate IE, "http://www.sdmccic.or.kr/?pno=050202&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&page=" + CStr(pageNum)
                GoSub doCraw
            Next
        End If
        
        '부모교육
        ChangeNavigate IE, "http://www.sdmccic.or.kr/?pno=050102&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month
        
        GoSub doCraw
        
        If Not IsEmpty(getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/v2/common/pg_last.png")) Then
            Set img = getElementByAttName(IE.document.getElementsByTagName("img"), "src", "/images/v2/common/pg_last.png")
            
            imghref = img.parentElement.getAttribute("href")
            startCom = InStr(imghref, "page=")
            pageLeng = CInt(Mid(imghref, startCom + 5))
            
            For pageNum = 2 To pageLeng
                ChangeNavigate IE, "http://www.sdmccic.or.kr/?pno=050102&mode=&cyear=" + CStr(targetYear) + "&cmonth=" + month + "&search=&page=" + CStr(pageNum)
                GoSub doCraw
            Next
        End If
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("board center")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.sdmccic.or.kr" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 양천구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "양천구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        j = monArr(i - 1)

        '보육보직원 교육
        ChangeNavigate IE, "http://www.ychccic.or.kr/childcare/program_staff.php?p_place=0&schYear=" + CStr(targetYear) + "&schMonth=" + CStr(i)
        GoSub doCraw
        
        '부모교육
        ChangeNavigate IE, "http://www.ychccic.or.kr/plaza/program_parent.php?p_place=0&schYear=" + CStr(targetYear) + "&schMonth=" + CStr(i)
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each element In IE.document.getElementsByClassName("monthList")(0).getElementsByTagName("div")
        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(element.Children(0).innerText) & vbCrLf
        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.ychccic.or.kr" + element.nextElementSibling.getAttribute("href")
        j = j + 1
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 강북구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "강북구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        month = CStr(i)
        j = monArr(i - 1)

        ChangeNavigate IE, "https://childcare.gangbuk.go.kr:60447/index.php?mt=page&mp=4_1&mm=calendar&cmd=user&subcmd=calendar&year=" + CStr(targetYear) + "&month=" + month + "&on="
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("ox_tbl")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://childcare.gangbuk.go.kr:60447/" + subject.Children(0).getAttribute("href")
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 용산구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "용산구육아종합지원센터"

    For idx = 0 To 11:
        monArr(idx) = startRow
    Next

    For i = 1 To 12
        j = monArr(i - 1)

        '보육보직원 교육
        ChangeNavigate IE, "http://www.ysccic.or.kr/sub/center/program_form.htm?schYear=" + CStr(targetYear) + "&schMonth=" + CStr(i)
        GoSub doCraw
        
        '부모교육
        ChangeNavigate IE, "http://www.ysccic.or.kr/sub/center/program_form2.htm?schYear=" + CStr(targetYear) + "&schMonth=" + CStr(i)
        GoSub doCraw
    Next
    
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1

    Exit Sub

doCraw:
    For Each element In IE.document.getElementsByClassName("monthList")(0).getElementsByTagName("div")
        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(element.Children(0).innerText) & vbCrLf
        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.ysccic.or.kr" + element.nextElementSibling.getAttribute("href")
        j = j + 1
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 중구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "중구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        month = CStr(i)
        j = monArr(i - 1)
        
        '보육보직원 교육
        ChangeNavigate IE, "http://kids.jgkids.or.kr:8080/bbs/mboard.asp?Action=list&strBoardID=education&intCategory=4&strSearchCategory=|s_name|s_subject|&strSearchWord=&strScYear=" + CStr(targetYear) + "&strScMonth=" + month + "&strScDay=" + CStr(getLastDay(DateSerial(targetYear, i, 1)))
        GoSub doCraw
        
        If IE.document.getElementsByTagName("font").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling)
                ClickButton IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '부모교육 및 행사
        ChangeNavigate IE, "http://kids.jgkids.or.kr:8080/bbs/mboard.asp?Action=list&strBoardID=education&intCategory=2&strSearchCategory=|s_name|s_subject|&strSearchWord=&strScYear=" + CStr(targetYear) + "&strScMonth=" + month + "&strScDay=" + CStr(getLastDay(DateSerial(targetYear, i, 1)))
        GoSub doCraw
        
        If IE.document.getElementsByTagName("font").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling)
                ClickButton IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '놀이
        ChangeNavigate IE, "http://kids.jgkids.or.kr:8080/bbs/mboard.asp?Action=list&strBoardID=education&intCategory=3&strSearchCategory=|s_name|s_subject|&strSearchWord=&strScYear=" + CStr(targetYear) + "&strScMonth=" + month + "&strScDay=" + CStr(getLastDay(DateSerial(targetYear, i, 1)))
        GoSub doCraw
        
        If IE.document.getElementsByTagName("font").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling)
                ClickButton IE.document.getElementsByTagName("font")(0).parentElement.nextElementSibling.nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("mt10 tb_notice")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    href = subject.Children(0).getAttribute("onclick")

                    startCom = InStr(href, "'")
                    endCom = InStr(startCom + 1, href, "'")
                    intSeq = Mid(href, startCom + 1, endCom - startCom - 1)
                    
                    startCom = InStr(endCom + 1, href, "'")
                    endCom = InStr(startCom + 1, href, "'")
                    strScYear = Mid(href, startCom + 1, endCom - startCom - 1)
                    
                    startCom = InStr(endCom + 1, href, "'")
                    endCom = InStr(startCom + 1, href, "'")
                    strScMonth = Mid(href, startCom + 1, endCom - startCom - 1)
                    
                    startCom = InStr(endCom + 1, href, "'")
                    endCom = InStr(startCom + 1, href, "'")
                    strScDay = Mid(href, startCom + 1, endCom - startCom - 1)
                    
                    'http://kids.jgkids.or.kr:8080/bbs/mboard.asp?Action=view&strBoardID=education&intPage=1&intCategory=4&strSearchCategory=|s_name|s_subject|&strSearchWord=&intSeq=20945&strScYear=2019&strScMonth=12&strScDay=18
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://kids.jgkids.or.kr:8080/bbs/mboard.asp?Action=view&strBoardID=education&intPage=1&intCategory=4&strSearchCategory=|s_name|s_subject|&strSearchWord=&intSeq=" + intSeq + "&strScYear=" + strScYear + "&strScMonth=" + strScMonth + "&strScDay=" + strScDay
                    j = j + 1
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 서울시육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "서울시육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        j = monArr(i - 1)
        
        '교육
        ChangeNavigate IE, "http://seoul.childcare.go.kr/ccef/centeredc/CenterEdcSlPL.jsp"
        
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        IE.document.getElementById("EDCBEGINDT").Value = CStr(targetYear) + "-" + month + "-" + "01"
        IE.document.getElementById("EDCENDDT").Value = CStr(targetYear) + "-" + month + "-" + CStr(getLastDay(DateSerial(targetYear, month, 1)))
        
        ClickButton IE.document.getElementsByClassName("button btn_position")(0).Children(0)
        WaitIE IE
        'Application.Wait DateAdd("s", 2, Now)
        
        GoSub doCraw2
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw2
             Loop
        End If

        '행사/교육
        ChangeNavigate IE, "http://seoul.childcare.go.kr/ccef/edcevent/EdcEventSlL.jsp?year=" + CStr(targetYear) + "&month=" + month
        
        month = CStr(i)
        
        GoSub doCraw1
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw1
             Loop
        End If
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://seoul.childcare.go.kr/ccef/edcevent/EdcEventSl.jsp?flag=Sl&EDCEVENTSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(4)) Then
            Set subject = article.Children(4)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://seoul.childcare.go.kr/ccef/centeredc/CenterEdcSl.jsp?flag=Sl&EDCSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 부산시육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "부산시육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        j = monArr(i - 1)
        
        '교육
        ChangeNavigate IE, "http://busan.childcare.go.kr/ccef/centeredc/CenterEdcSlPL.jsp?ccode=0200&DATEGB=Y"
        
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        IE.document.getElementById("EDCBEGINDT").Value = CStr(targetYear) + "-" + month + "-" + "01"
        IE.document.getElementById("EDCENDDT").Value = CStr(targetYear) + "-" + month + "-" + CStr(getLastDay(DateSerial(targetYear, month, 1)))
                                               
        ClickButton IE.document.getElementsByClassName("button btn_position")(0).Children(0)
        WaitIE IE
        'Application.Wait DateAdd("s", 2, Now)
        
        GoSub doCraw2
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw2
             Loop
        End If

        '행사/교육
        month = CStr(i)
        ChangeNavigate IE, "http://busan.childcare.go.kr/ccef/edcevent/EdcEventSlL.jsp?year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw1
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw1
             Loop
        End If
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://busan.childcare.go.kr/ccef/edcevent/EdcEventSl.jsp?flag=Sl&EDCEVENTSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(4)) Then
            Set subject = article.Children(4)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://busan.childcare.go.kr/ccef/centeredc/CenterEdcSl.jsp?flag=Sl&EDCSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 사상구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "사상구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    month = CStr(i)
    
    '보육보직원 교육
    ChangeNavigate IE, "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=02&groupid=03"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "보육"
    If IE.document.getElementsByClassName("pagination").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling.Children(0)
            WaitIE IE
            GoSub doCraw
        Loop
    End If
    
    '부모교육 신청
    ChangeNavigate IE, "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=01&groupid=07"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "부모"
    If IE.document.getElementsByClassName("pagination").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling.Children(0)
            WaitIE IE
            GoSub doCraw
        Loop
    End If
    
    '행사(기관)
    ChangeNavigate IE, "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=03&groupid=03"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "기관"
    If IE.document.getElementsByClassName("pagination").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling.Children(0)
            WaitIE IE
            GoSub doCraw
        Loop
    End If
    
    '행사(개인)
    ChangeNavigate IE, "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=03&groupid=02"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "개인"
    If IE.document.getElementsByClassName("pagination").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling.Children(0)
            WaitIE IE
            GoSub doCraw
        Loop
    End If
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("boardList")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    calen = article.Children(3).innerText
                    startCom = InStr(calen, "-")
                    endCom = InStr(startCom + 1, calen, "-")
                    If InStr(calen, ":") = 0 Then
                        nun = Mid(calen, 1, 4)
                    Else
                        nun = Mid(calen, InStr(calen, ":") + 2, 4)
                    End If
                    i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                    j = monArr(i - 1)
                    
                    If targetYear = nun Then
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                        
                        onclick = subject.Children(0).getAttribute("onclick")
                        startCom = InStr(onclick, "'")
                        endCom = InStr(startCom + 1, onclick, "'")
                        seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                        
                        If goyuk = "보육" Then
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=02&groupid=03&no=" + seq + "&board=view"
                        ElseIf goyuk = "부모" Then
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=01&groupid=07&no=" + seq + "&board=view"
                        ElseIf goyuk = "기관" Then
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=03&groupid=03&no=" + seq + "&board=view"
                        ElseIf goyuk = "개인" Then
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.sasangicare.kr/main/main.php?categoryid=05&menuid=03&groupid=02&no=" + seq + "&board=view"
                        End If
                        
                        j = j + 1
                        monArr(i - 1) = j
            
                        If temp < j Then
                            temp = j
                        End If
                    End If
            
                    If targetYear > nun Then
                        yearFlag = True
                        Exit For
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 부산진구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "부산진구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)
        
        '보육교직원 교육
        goyuk = "보육"
        ChangeNavigate IE, "http://bjscfc.or.kr/m3/sub4_2.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '부모 교육
        goyuk = "부모"
        ChangeNavigate IE, "http://bjscfc.or.kr/m2/sub8.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("list cate2")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0).Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
                    
                    If goyuk = "보육" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://bjscfc.or.kr/m3/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "부모" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://bjscfc.or.kr/m2/" + subject.Children(0).Children(0).getAttribute("href")
                    End If
                    
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 기장군육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "기장군육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)
        
        '보육교직원 교육
        goyuk = "보육"
        ChangeNavigate IE, "http://gijangchild.or.kr/m4/sub4_3.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '부모 교육
        goyuk = "부모"
        ChangeNavigate IE, "http://gijangchild.or.kr/m3/sub2_2.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '특색사업
        goyuk = "사업"
        ChangeNavigate IE, "http://gijangchild.or.kr/m8/sub2.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("list cate2")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(3)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0).Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
        
                    If goyuk = "보육" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://gijangchild.or.kr/m4/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "부모" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://gijangchild.or.kr/m3/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "사업" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://gijangchild.or.kr/m8/" + subject.Children(0).Children(0).getAttribute("href")
                    End If
                    
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 해운대구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "해운대구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    month = CStr(i)
    
    '보육보직원 교육
    ChangeNavigate IE, "http://ecohud.or.kr/04/01_03.php"
    GoSub doCraw1
    
    yearFlag = False
    goyuk = "보육"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw1
        Loop
    End If
    
    '공통부모교육 신청
    ChangeNavigate IE, "http://ecohud.or.kr/04/11_02.php"
    GoSub doCraw2
    
    yearFlag = False
    goyuk = "공통"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw2
        Loop
    End If
    
    '부모교육 신청
    ChangeNavigate IE, "http://ecohud.or.kr/03/01.php"
    GoSub doCraw2
    
    yearFlag = False
    goyuk = "부모"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw2
        Loop
    End If
    
    '체험
    ChangeNavigate IE, "http://ecohud.or.kr/03/02.php"
    GoSub doCraw2
    
    yearFlag = False
    goyuk = "체험"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw2
        Loop
    End If
    
    '행사
    ChangeNavigate IE, "http://ecohud.or.kr/02/08.php"
    GoSub doCraw2
    
    yearFlag = False
    goyuk = "행사"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw2
        Loop
    End If
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("board-list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    calen = article.Children(2).innerText
                    
                    If Not (calen = "") Then
                        startCom = InStr(calen, ".")
                        endCom = InStr(startCom + 1, calen, ".")
                        If InStr(calen, ":") = 0 Then
                            nun = Mid(calen, 1, 4)
                        Else
                            nun = Mid(calen, InStr(calen, ":") + 2, 4)
                        End If
                        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                        j = monArr(i - 1)
                        
                        If targetYear = nun Then
                            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://ecohud.or.kr" + subject.Children(0).getAttribute("href")
                            
                            j = j + 1
                            monArr(i - 1) = j
                
                            If temp < j Then
                                temp = j
                            End If
                        End If
                
                        If targetYear > nun Then
                            yearFlag = True
                            Exit For
                        End If
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("board-list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0).Children(0)) Then
                    calen = article.Children(3).innerText
                    
                    If Not (calen = "") Then
                        startCom = InStr(calen, ".")
                        endCom = InStr(startCom + 1, calen, ".")
                        If InStr(calen, ":") = 0 Then
                            nun = Mid(calen, 1, 4)
                        Else
                            nun = Mid(calen, InStr(calen, ":") + 2, 4)
                        End If
                        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                        j = monArr(i - 1)
                        
                        If targetYear = nun Then
                            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://ecohud.or.kr" + subject.Children(0).Children(0).getAttribute("href")
                            
                            j = j + 1
                            monArr(i - 1) = j
                
                            If temp < j Then
                                temp = j
                            End If
                        End If
                
                        If targetYear > nun Then
                            yearFlag = True
                            Exit For
                        End If
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 동래구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "동래구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    month = CStr(i)
    
    '보육보직원 교육
    ChangeNavigate IE, "http://bdscc.or.kr/03/04_03.php"
    GoSub doCraw1
    
    yearFlag = False
    goyuk = "보육"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw1
        Loop
    End If
    
    '부모교육 신청
    ChangeNavigate IE, "http://bdscc.or.kr/02/03_02.php"
    GoSub doCraw2
    
    yearFlag = False
    goyuk = "부모"
    If IE.document.getElementsByClassName("page_num").Length > 0 Then
        Do Until IsNull(IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling)
            If yearFlag Then
                Exit Do
            End If
            ClickButton IE.document.getElementsByClassName("page_num")(0).getElementsByTagName("strong")(0).nextElementSibling
            WaitIE IE
            GoSub doCraw2
        Loop
    End If
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("board-list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    calen = article.Children(2).innerText
                    
                    If Not (calen = "") Then
                        startCom = InStr(calen, ".")
                        endCom = InStr(startCom + 1, calen, ".")
                        If InStr(calen, ":") = 0 Then
                            nun = Mid(calen, 1, 4)
                        Else
                            nun = Mid(calen, InStr(calen, ":") + 2, 4)
                        End If
                        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                        j = monArr(i - 1)
                        
                        If targetYear = nun Then
                            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://bdscc.or.kr" + subject.Children(0).getAttribute("href")
                            
                            j = j + 1
                            monArr(i - 1) = j
                
                            If temp < j Then
                                temp = j
                            End If
                        End If
                
                        If targetYear > nun Then
                            yearFlag = True
                            Exit For
                        End If
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("board-list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0).Children(0)) Then
                    calen = article.Children(3).innerText
                    
                    If Not (calen = "") Then
                        startCom = InStr(calen, ".")
                        endCom = InStr(startCom + 1, calen, ".")
                        If InStr(calen, ":") = 0 Then
                            nun = Mid(calen, 1, 4)
                        Else
                            nun = Mid(calen, InStr(calen, ":") + 2, 4)
                        End If
                        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                        j = monArr(i - 1)
                        
                        If targetYear = nun Then
                            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://bdscc.or.kr" + subject.Children(0).Children(0).getAttribute("href")
                            
                            j = j + 1
                            monArr(i - 1) = j
                
                            If temp < j Then
                                temp = j
                            End If
                        End If
                
                        If targetYear > nun Then
                            yearFlag = True
                            Exit For
                        End If
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 연제구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "연제구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    month = CStr(i)
    
    '보육보직원 교육
    ChangeNavigate IE, "http://yjscfc.or.kr/html/kid_p04_1.php"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "보육"
    
    If IE.document.getElementsByClassName("reserv_all").Length > 0 Then
        lastHref = IE.document.getElementsByClassName("reserv_all")(0).Children(0).getAttribute("href")
        startCom = InStr(lastHref, "page=")
        pageLeng = CInt(Mid(lastHref, startCom + 5))
        
        For pageNum = 2 To pageLeng
            If yearFlag Then
                Exit For
            End If
            ChangeNavigate IE, "http://yjscfc.or.kr/html/kid_p04_1.php?page=" + CStr(pageNum)
            GoSub doCraw
        Next
    End If
    
    '부모교육 신청
    ChangeNavigate IE, "http://yjscfc.or.kr/html/family_p03_2.php"
    GoSub doCraw
    
    yearFlag = False
    goyuk = "부모"
    
    If IE.document.getElementsByClassName("reserv_all").Length > 0 Then
        lastHref = IE.document.getElementsByClassName("reserv_all")(0).Children(0).getAttribute("href")
        startCom = InStr(lastHref, "page=")
        pageLeng = CInt(Mid(lastHref, startCom + 5))
        
        For pageNum = 2 To pageLeng
            If yearFlag Then
                Exit For
            End If
            ChangeNavigate IE, "http://yjscfc.or.kr/html/family_p03_2.php?page=" + CStr(pageNum)
            GoSub doCraw
        Next
    End If
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("reserv_board2")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(2)) Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    calen = article.Children(1).innerText
                    
                    If Not (calen = "") Then
                        startCom = InStr(calen, "-")
                        endCom = InStr(startCom + 1, calen, "-")
                        If InStr(calen, ":") = 0 Then
                            nun = Mid(calen, 1, 4)
                        Else
                            nun = Mid(calen, InStr(calen, ":") + 2, 4)
                        End If
                        i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
                        j = monArr(i - 1)
                        
                        If targetYear = nun Then
                            Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                            Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://yjscfc.or.kr/html" + Mid(subject.Children(0).getAttribute("href"), 2)
                            
                            j = j + 1
                            monArr(i - 1) = j
                
                            If temp < j Then
                                temp = j
                            End If
                        End If
                
                        If targetYear > nun Then
                            yearFlag = True
                            Exit For
                        End If
                    End If
                End If
            End If
        End If
    Next

    monArr(i - 1) = j

    If temp < j Then
        temp = j
    End If
Return
End Sub

Sub 수영구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "수영구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)
        
        '보육교직원 교육
        goyuk = "보육"
        ChangeNavigate IE, "http://www.bsyscc.or.kr/m4/sub4_3.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '부모 교육
        goyuk = "부모"
        ChangeNavigate IE, "http://www.bsyscc.or.kr/m3/sub3.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '가족문화행사
        goyuk = "행사"
        ChangeNavigate IE, "http://www.bsyscc.or.kr/m3/sub9.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("list type2")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(3)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0).Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
        
                    If goyuk = "보육" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.bsyscc.or.kr/m4/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "부모" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.bsyscc.or.kr/m3/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "행사" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.bsyscc.or.kr/m3/" + subject.Children(0).Children(0).getAttribute("href")
                    End If
                    
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 북구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "북구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)
        
        '보육교직원 교육
        goyuk = "보육"
        ChangeNavigate IE, "https://www.bbgscc.or.kr/m4/sub3_2.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '부모 교육
        goyuk = "부모"
        ChangeNavigate IE, "https://www.bbgscc.or.kr/m3/sub3_2.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
        
        '가족문화행사
        goyuk = "행사"
        ChangeNavigate IE, "https://www.bbgscc.or.kr/m2/sub4.asp?datToday=" + CStr(targetYear) + month + "&search1=#cal"
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("list mTable")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(3)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    If goyuk = "보육" Then
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.bbgscc.or.kr/m4/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "부모" Then
                        Set subject = article.Children(2)
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).Children(0).innerText) & vbCrLf
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.bbgscc.or.kr/m3/" + subject.Children(0).Children(0).getAttribute("href")
                    ElseIf goyuk = "행사" Then
                        Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.bbgscc.or.kr/m2/" + subject.Children(0).getAttribute("href")
                    End If
                    
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 대구시육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "대구시육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        j = monArr(i - 1)
        
        '보육교직원 교육
        ChangeNavigate IE, "http://daegu.childcare.go.kr/ccef/centeredc/CenterEdcSlPL.jsp?ccode=0200&DATEGB=Y"
        
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        IE.document.getElementById("EDCBEGINDT").Value = CStr(targetYear) + "-" + month + "-" + "01"
        IE.document.getElementById("EDCENDDT").Value = CStr(targetYear) + "-" + month + "-" + CStr(getLastDay(DateSerial(targetYear, month, 1)))
                                               
        ClickButton IE.document.getElementsByClassName("button btn_position")(0).Children(0)
        WaitIE IE
        'Application.Wait DateAdd("s", 2, Now)
        
        GoSub doCraw2
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw2
             Loop
        End If

        '행사/교육
        month = CStr(i)
        ChangeNavigate IE, "http://daegu.childcare.go.kr/ccef/edcevent/EdcEventSlL.jsp?year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw1
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw1
             Loop
        End If
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://daegu.childcare.go.kr/ccef/edcevent/EdcEventSl.jsp?flag=Sl&EDCEVENTSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(4)) Then
            Set subject = article.Children(4)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://daegu.childcare.go.kr/ccef/centeredc/CenterEdcSl.jsp?flag=Sl&EDCSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 대구동구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String
    
    InitCenter "대구동구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        month = CStr(i)
        j = monArr(i - 1)
        
        '보육교직원 교육
        ChangeNavigate IE, "http://www.dgicare.kr/daycare/08_02.htm?year=" + CStr(targetYear) + "&month=" + month
        goyuk = "보육"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("ver11").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If

        '부모교육(육아종합지원센터)
        ChangeNavigate IE, "http://www.dgicare.kr/nurture/03_02.htm?year=" + CStr(targetYear) + "&month=" + month
        goyuk = "부모(육아)"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("ver11").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '부모교육(영유아)
        ChangeNavigate IE, "http://www.dgicare.kr/plaza/05_02.htm?year=" + CStr(targetYear) + "&month=" + month
        goyuk = "부모(영유아)"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("ver11").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '가족문화행사(육아종합지원센터)
        ChangeNavigate IE, "http://www.dgicare.kr/center/06.htm?year=" + CStr(targetYear) + "&month=" + month
        goyuk = "행사(육아)"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("ver11").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
        
        '가족문화행사(영유아)
        ChangeNavigate IE, "http://www.dgicare.kr/plaza/07.htm?year=" + CStr(targetYear) + "&month=" + month
        goyuk = "행사(영유아)"
        
        GoSub doCraw
        
        If IE.document.getElementsByClassName("ver11").Length > 0 Then
            Do Until IsNull(IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("ver11")(0).getElementsByTagName("font")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw
            Loop
        End If
    Next

Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub
    
doCraw:
    For Each article In IE.document.getElementsByClassName("board_list")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://www.dgicare.kr" + subject.Children(0).getAttribute("href")
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 인천시육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "인천시육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        j = monArr(i - 1)
        
        '보육교직원 교육
        ChangeNavigate IE, "http://incheon.childcare.go.kr/ccef/centeredc/CenterEdcSlPL.jsp?ccode=0200&DATEGB=Y"
        
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        IE.document.getElementById("EDCBEGINDT").Value = CStr(targetYear) + "-" + month + "-" + "01"
        IE.document.getElementById("EDCENDDT").Value = CStr(targetYear) + "-" + month + "-" + CStr(getLastDay(DateSerial(targetYear, month, 1)))
                                               
        ClickButton IE.document.getElementsByClassName("button btn_position")(0).Children(0)
        WaitIE IE
        
        GoSub doCraw2
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw2
             Loop
        End If

        '행사/교육
        month = CStr(i)
        ChangeNavigate IE, "http://incheon.childcare.go.kr/ccef/edcevent/EdcEventSlL.jsp?year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw1
        
        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 1 Then
            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling)
                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByTagName("strong")(0).nextElementSibling
                WaitIE IE
                GoSub doCraw1
             Loop
        End If
        
        '부모교육
'        If i < 10 Then
'            month = "0" + CStr(i)
'        Else
'            month = CStr(i)
'        End If
'        ChangeNavigate IE, "http://bumo.iccic.or.kr/main/main.php?categoryid=03&menuid=02&groupid=02&ymd=" + CStr(targetYear) + "-" + month + "-01"
'        GoSub doCraw3
'
'        If IE.document.getElementsByClassName("pagination")(0).Children.Length > 4 Then
'            Do Until IsNull(IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling)
'                If Not (IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling.tagName = "span") Then
'                    Exit Do
'                End If
'                ClickButton IE.document.getElementsByClassName("pagination")(0).getElementsByClassName("select")(0).nextElementSibling
'                WaitIE IE
'                GoSub doCraw3
'             Loop
'        End If
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw1:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://incheon.childcare.go.kr/ccef/edcevent/EdcEventSl.jsp?flag=Sl&EDCEVENTSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return

doCraw2:
    For Each article In IE.document.getElementsByClassName("com_list1")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(4)) Then
            Set subject = article.Children(4)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://incheon.childcare.go.kr/ccef/centeredc/CenterEdcSl.jsp?flag=Sl&EDCSEQ=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return

doCraw3:
    For Each article In IE.document.getElementsByClassName("listBoard marT30")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(1)) Then
            Set subject = article.Children(1)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    onclick = subject.Children(0).getAttribute("onclick")
                    startCom = InStr(onclick, "'")
                    endCom = InStr(startCom + 1, onclick, "'")
                    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
                    
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "http://bumo.iccic.or.kr/main/main.php?categoryid=03&menuid=02&groupid=02&board=view&no=" + seq
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 인천부평구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "인천부평구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        j = monArr(i - 1)
        
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        '교육 및 행사
        ChangeNavigate IE, "http://www.jbpeducare.or.kr/bbs/board.php?bo_table=s4_2_1&year=" + CStr(targetYear) + "&month=" + month
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementsByClassName("tbl_head01 tbl_wrap")(0).getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not (article.getAttribute("class") = "bo_notice") Then
            Set subject = article.Children(2)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), subject.Children(0).getAttribute("href")
                        
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub 인천미추홀구육아종합지원센터(ByRef IE As Object)
    Dim i As Integer, j As Integer, temp As Integer, monArr(12) As Integer, month As String

    InitCenter "인천미추홀구육아종합지원센터"
    
    For idx = 0 To 11:
        monArr(idx) = startRow
    Next
    
    For i = 1 To 12
        If i < 10 Then
            month = "0" + CStr(i)
        Else
            month = CStr(i)
        End If
        
        j = monArr(i - 1)
        
        '보육교직원 교육
        goyuk = "보육"
        ChangeNavigate IE, "https://www.nccic.or.kr/m3/sub5.asp?datToday=" + CStr(targetYear) + month + "&code=01&gubun2=#cal"
        GoSub doCraw
        
        '부모 교육
        goyuk = "부모"
        ChangeNavigate IE, "https://www.nccic.or.kr/m3/sub5.asp?datToday=" + CStr(targetYear) + month + "&code=02&gubun2=#cal"
        GoSub doCraw
    Next
    
Final:
    AdStyle startRow - 1, temp - 1
    startRow = temp + 1
Exit Sub

doCraw:
    For Each article In IE.document.getElementById("list").getElementsByTagName("tbody")(0).getElementsByTagName("tr")
        If Not IsEmpty(article.Children(3)) Then
            Set subject = article.Children(3)
            If Not (subject Is Nothing) Then
                If Not IsEmpty(subject.Children(0)) Then
                    Sheets(sheetName).Cells(j, i) = vbCrLf & Trim(subject.Children(0).innerText) & vbCrLf
                    
                    If goyuk = "보육" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.nccic.or.kr/m3/" + subject.Children(0).getAttribute("href")
                    ElseIf goyuk = "부모" Then
                        Sheets(sheetName).Hyperlinks.Add Sheets(sheetName).Cells(j, i), "https://www.nccic.or.kr/m3/" + subject.Children(0).getAttribute("href")
                    End If
                    
                    j = j + 1
                    monArr(i - 1) = j
        
                    If temp < j Then
                        temp = j
                    End If
                End If
            End If
        End If
    Next
Return
End Sub

Sub IE_Automation()

    ' 변수 선언
    Dim i As Long
    Dim o As Object
    Dim IE As Object
    Dim objCollection As Object
    Dim objInputElement As Object
    Dim objSelectElement As Object
    Dim objButtonElement As Object

    ' Internet Explorer 열기
    Set IE = CreateObject("InternetExplorer.Application")
    IE.Top = 0
    IE.Left = 0
    IE.Height = 1000
    IE.Width = 1600
    IE.Visible = True
    IE.navigate "C:\Users\test\Desktop\main.html"

    ' 페이지 로드 대기
    Do While IE.Busy
    Application.Wait DateAdd("s", 1, Now)
    Loop
    Debug.Print "페이지 로드 완료"

    ' textbox에 값 입력
    Set objInputElement = IE.document.getElementsByName("name")(0)
    objInputElement.Value = "문타리"

    ' selectbox 선택하기
    Set objSelectElement = IE.document.getElementById("age")
    For Each o In objSelectElement.Options
    If o.Value = "30" Then
        o.Selected = True
        Exit For
    End If
    Next

    ' 스크립트 재정의
    With IE.document.parentWindow
    .execScript "window.alert = function(){return true;};", "JScript"
    .execScript "window.showModalDialog = function(){return 'Success';};", "JScript"
    End With

    ' button 클릭
    Set objCollection = IE.document.getElementsByTagName("button")
    i = 0
    While i < objCollection.Length
    If objCollection(i).innerText = "제출" Then
        Set objButtonElement = objCollection(i)
    End If
    i = i + 1
    Wend
    objButtonElement.Click

    ' Internet Explorer 닫기
    IE.Quit

End Sub

Function OpenIE(ByRef IE As Object)
    Set IE = CreateObject("InternetExplorer.Application")
End Function

Function ChangeNavigate(ByRef IE As Object, ByVal url As String)
    Debug.Print url
    With IE
    .navigate url
    .Visible = False
    End With

    WaitIE IE
    Debug.Print "페이지 로드 완료"
End Function

Function WaitIE(ByRef IE As Object)
    'Do While IE.ReadyState = 4: DoEvents: Loop
    'Do Until IE.ReadyState = 4: DoEvents: Loop
    
    Do While IE.Busy
        Application.Wait DateAdd("s", 1, Now)
    Loop
'    Do While IE.readyState <> 4
'        DoEvents
'    Loop
End Function

Function CloseIE(ByRef IE As Object)
    IE.Quit
End Function

Function ChoiceSelectBox(ByRef selectElement As Object, ByVal selectValue As String)
    'Set objSelectElement = IE.document.getElementById("age")
    For Each o In selectElement.Options
    If o.Value = selectValue Then
        o.Selected = True
        Exit For
    End If
    Next
End Function

Function ClickButton(ByRef buttonElement)
    buttonElement.Click
End Function

Sub InitCenter(ByVal title As String)
    Debug.Print title
    InsertTitle title
    startRow = startRow + 1
    InsertMonth
    startRow = startRow + 1
End Sub

Sub InsertTitle(ByVal title As String)
    With Sheets(sheetName).Cells(startRow, 1)
        .Value = title
        .rowHeight = 42
        .Interior.Color = RGB(255, 192, 0)
        .Font.Size = 14
        .Font.Name = "맑은 고딕"
    End With
    
    With Sheets(sheetName).Range(Cells(startRow, 1), Cells(startRow, 12))
        .Merge
        .BorderAround LineStyle:=xlContinuous, Weight:=3
    End With
End Sub

Sub InsertMonth()
    For i = 1 To 12
        With Sheets(sheetName).Cells(startRow, i)
            .Value = CStr(i) + "월"
            .rowHeight = 23
            .Interior.Color = RGB(248, 203, 173)
            .Font.Size = 11
            .Font.Name = "맑은 고딕"
        End With
    Next
End Sub

Sub AdStyle(ByVal startRow As Integer, ByVal endRow As Integer)
    With Sheets(sheetName).Range(Cells(startRow, 1), Cells(endRow, 12)).Borders
        .LineStyle = 1      ' 실선(xlContinuous)으로 그려라
        '.ColorIndex = 14    ' 색상은 http://link2me.tistory.com/260 참조
        .Weight = xlThin    ' xlThin : 가는 실선, xlThick : 굵은 실선
    End With
    Sheets(sheetName).Range(Cells(startRow + 1, 1), Cells(endRow, 12)).Font.Name = "굴림체"
    Sheets(sheetName).Range(Cells(startRow - 1, 1), Cells(endRow, 12)).BorderAround LineStyle:=xlContinuous, Weight:=3 ', ColorIndex:=22
End Sub

Function getElementByAttName(ByVal elements As Object, ByVal attributeName As String, ByVal attributeValue As String)
    For Each element In elements
        If element.getAttribute(attributeName) = attributeValue Then
            Set getElementByAttName = element
            Exit For
        End If
    Next
End Function

Function getLastDay(ddate As Date) As Integer
    getLastDay = Day(DateSerial(Year(ddate), month(ddate) + 1, 0))
End Function

Sub DoPostHttpclient()
    Dim xmlhttp As New MSXML2.XMLHTTP60, html As New HTMLDocument
    url = "http://gncare.go.kr/gnccic/education/choiceGubun.php"
    
    With xmlhttp
        .Open "POST", url, False
        .setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
        .send "GUBUN=0&STATUS=&EDU_YEAR=2020&EDU_MONTH=8&EDU_DAY="
        html.body.innerHTML = xmlhttp.responseText
    End With
    MsgBox html.querySelectorAll("a")(0).getAttribute("href")
End Sub

Sub Test()
    'href = "doBbsFView('494','113784','16010100','113784');return false;"
    href = "javascript:OnReadArticle('20945','2019','12','18','1');"
    
    startCom = InStr(href, "'")
    endCom = InStr(startCom + 1, href, "'")
    intSeq = Mid(href, startCom + 1, endCom - startCom - 1)
    
    startCom = InStr(endCom + 1, href, "'")
    endCom = InStr(startCom + 1, href, "'")
    strScYear = Mid(href, startCom + 1, endCom - startCom - 1)
    
    startCom = InStr(endCom + 1, href, "'")
    endCom = InStr(startCom + 1, href, "'")
    strScMonth = Mid(href, startCom + 1, endCom - startCom - 1)
    
    startCom = InStr(endCom + 1, href, "'")
    endCom = InStr(startCom + 1, href, "'")
    strScDay = Mid(href, startCom + 1, endCom - startCom - 1)
    
    MsgBox intSeq & strScYear & strScMonth & strScDay
End Sub

Sub Test2()
    calen = "교육기간 : 2020-07-06~2020-07-08"
    startCom = InStr(calen, "-")
    endCom = InStr(startCom + 1, calen, "-")
    nun = Mid(calen, InStr(calen, ":") + 2, 4)
    i = CInt(Mid(calen, startCom + 1, endCom - startCom - 1))
    
    MsgBox nun
    MsgBox i
End Sub

Sub Test3()
    href = "/html/sub/index.php?pno=030201&mode=&cyear=2020&cmonth=08&search=&0=&page=40"
    startCom = InStr(href, "page=")
    i = CInt(Mid(href, startCom + 5))
    
    MsgBox i
End Sub

Sub Test4()
    onclick = "fnGoDetail('29694');return false"
    startCom = InStr(onclick, "'")
    endCom = InStr(startCom + 1, onclick, "'")
    seq = Mid(onclick, startCom + 1, endCom - startCom - 1)
    
    MsgBox seq
    
End Sub

Sub Test5()
    yeee = "2020"
    MsgBox getLastDay(DateSerial(yeee, 2, 1))
End Sub

Sub Test6()
    href = "javascript:doPagingClick('11')"
    startCom = InStr(href, "'")
    endCom = InStr(startCom + 1, href, "'")
    cpage = CInt(Mid(href, startCom + 1, endCom - startCom - 1))
    
    MsgBox cpage
End Sub
    </pre>
</body>
</html>
